{# mypage.html #}
{% extends "layout.html" %}
{% block nav %}
{% include "nav.tpl" %}
{% endblock %}
{% block pageinfo %}
<script>
document.addEventListener("DOMContentLoaded", function (event) {
        let navMypage = document.querySelector("li#mypage");
        navMypage.classList.add("active");
        navMypage.classList.add("font-weight-bold");
        navMypage.classList.add("font-italic");
        let datatableOptions =     {
                "lengthMenu": [5, 10, 20, 30, 40, 50],
                "displayLength": 5,
                "columnDefs": [
                    { "targets": [5], "orderable": false },
                ],
                "language": {
                    //filter
                    "lengthMenu": "Display _MENU_ reviews",
                },
                // footer 
                "infoCallback": function (settings, start, end, max, total, pre) {
                    return '<span class="px-2 font-italic">' + start + " / " + end + " entries" + '</span>';
                }
        };

        $('#tableMybookreview').DataTable(
           datatableOptions
        );
        
        datatableOptions["columnDefs"][0]={ "targets": [6], "orderable": false },
        $('#tableRecentBookReview').DataTable(
           datatableOptions
        );
});
</script>

<div class="row mt-2">
    <div class="col-sm-6">

        <div class="alert alert-info" role="alert">
                <a href="{{ url_for('showUserAccount') }}">User:{{session['username']}}</a>
        </div>
    </div>
    <div class="col-sm-6">
        <div class="alert alert-info" role="alert">
            Total Number of Review:{{ my_book_reviews | length }}
        </div>
    </div>
</div>
{% endblock %}
{% block body %}
<!-- <hr  class="my-4" /> -->
<div class="row ">
  <div class="col-sm">
    <div class="alert alert-primary" role="alert"><strong>Search Book</strong> - Click Here >>
        <div class="btn btn-outline-primary">
            <a href="{{ url_for('search') }}" >Search Book</a>
        </div>
    </div>
  </div>
</div>
<!-- <hr  class="my-1" /> -->
<div class="row">
  <div class="col-sm">
    <h3 class="bg-primary text-white p-2 mb-2" >My Book Reviews</h3>
    {% if my_book_reviews is defined and my_book_reviews | length  %}
    <table class="table" style="table-layout:fixed;"  id="tableMybookreview" >
        <thead>
        <tr>
            <th>Date</th>
            <th>Title</th>
            <th>Author</th>
            <th>Year</th>
            <th>Rate</th>
            <th>Comment</th>
            <!-- <th> </th> -->
        </tr>
        </thead>
        <tbody>
    
    {% for my_book_review in my_book_reviews %}
        <tr >
            <td>{{ my_book_review["created_at"].strftime('%Y-%m-%d %H:%M:%S') }}</td>
            <td>{{ my_book_review["title"] }}</td>
            <td>{{ my_book_review["author"] }}</td>
            <td>{{ my_book_review["year"] }}</td>
            <td>
            {% if my_book_review["rate"] == 1  %}
                ★☆☆☆☆
            {% elif my_book_review["rate"] == 2 %}
                ★★☆☆☆
            {% elif my_book_review["rate"] == 3 %}
                ★★★☆☆
            {% elif my_book_review["rate"] == 4 %}
                ★★★★☆
            {% elif my_book_review["rate"] == 5 %}
                ★★★★★
            {% endif %}
            </td>
            <!-- <td  style="overflow:hidden;" >{{ my_book_review["comment"] | nl2br }}</td> -->
            <td><a class="badge badge-primary" href="{{ url_for('searchBook') }}?isbn={{ my_book_review['isbn'] }}" >view</a></td>
        </tr>
    {% endfor %}
</tbody>    
        
</table>
    {% else %}
    <p>No Entries </p>
    {% endif %}
    </div>
</div>
<div class="row">
  <div class="col-sm">
   <h3 class="bg-primary text-white p-2 mb-2" >Rcent Book Reviews</h3>
   
    {% if recent_book_reviews is defined and recent_book_reviews | length %}
        <table class="table" style="table-layout:fixed;" id="tableRecentBookReview" >
            <thead>
            <tr>
                <th>Date</th>
                <th>Username</th>
                <th>Title</th>
                <th>Author</th>
                <th>Year</th>
                <th>Rate</th>
                <th>Comment</th>
                <!-- <th>        </th> -->
            </tr>
         </thead>
    <tbody>     
    {% for recent_book_review in recent_book_reviews %}
    <tr>
        <td>{{ recent_book_review["created_at"].strftime('%Y-%m-%d %H:%M:%S') }}</td>
        <td>{{ recent_book_review["username"] }}</td>
        <td>{{ recent_book_review["title"] }}</td>
        <td>{{ recent_book_review["author"] }}</td>
        <td>{{ recent_book_review["year"] }}</td>
        
        <td>
        {% if recent_book_review["rate"] == 1  %}
            ★☆☆☆☆
        {% elif recent_book_review["rate"] == 2 %}
            ★★☆☆☆
        {% elif recent_book_review["rate"] == 3 %}
            ★★★☆☆
        {% elif recent_book_review["rate"] == 4 %}
            ★★★★☆
        {% elif recent_book_review["rate"] == 5 %}
            ★★★★★
        {% endif %}
        </td>
        <!-- <td   style="overflow:hidden;"  >{{ recent_book_review["comment"] | nl2br }}</td> -->
        <td><a class="badge badge-primary" href="{{ url_for('searchBook') }}?isbn={{ recent_book_review['isbn'] }}">view</a></td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
    {% else %}
    <p>No Entries </p>
    {% endif %}
  </div>
</div>
<hr  class="my-4" />
<div class="row">
  <div class="col-sm">
    <div class="alert alert-primary" role="alert"><strong>Search Book</strong> - Click Here >>
        <div class="btn btn-outline-primary">
            <a href="{{ url_for('search') }}" >Search Book</a>
        </div>
    </div>
  </div>
</div>

{% endblock %}
